<ui:composition xmlns="http://www.w3.org/1999/xhtml"
       			xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                template="/WEB-INF/templates/template.xhtml">
    <ui:param name="idForm" value="frm"/>
    <ui:param name="controller" value="#{busquedaProformaFacturaController}"/>
    <ui:define name="contentBody">
		<p:panel header="#{msg.lbl_factura}">
				  	<p:fieldset legend="#{msg['lbl_busqueda']}">
				  			<h:panelGrid columns="3" id="pnlfilter">
				  				<p:outputLabel value="#{msg['lbl_numero_factura']}:" for="numproforma"/>
				  				<p:inputText id="numproforma" value="#{busquedaProformaFacturaDatamanager.numerofactura}" style="display:block;width:180px"/>
				  				<p:message for="numproforma"/>
				  				
				  				<p:outputLabel value="#{msg.lbl_estado}:" for="estadosri" style="display:block;width:140px;"/>
								<p:selectOneMenu id="estadosri" value="#{busquedaProformaFacturaDatamanager.codigoparamsri}"  var="p" style="width:180px" panelStyle="width:180px" >						
									<f:selectItem itemLabel="Seleccione" itemValue="" />
									<f:selectItems value="#{busquedaProformaFacturaDatamanager.tadmparamsriList}" var="item" itemValue="#{item.pk.codigoparamsri}" itemLabel="#{item.descripcion}" />
								</p:selectOneMenu>	
								<p:message for="estadosri" display="icon"/>
				  			</h:panelGrid>
				  			<h:panelGrid columns="4"  id="pnlfilterFecha">
				  				<p:outputLabel value="#{msg['lbl_fecha']} Desde:" for="fechainicio"  style="display:block;width:140px;"/>
				  				<p:calendar id="fechainicio" value="#{busquedaProformaFacturaDatamanager.fechamin}"  style="display:block;width:180px;" required="true" 
										    	pattern="#{msg['pattern_date']}" mask="true"/>
								<p:outputLabel value="Hasta:" for="fechafin"  style="display:block;width:140px;"/>
								<p:calendar id="fechafin" value="#{busquedaProformaFacturaDatamanager.fechamax}"  style="display:block;width:180px;" required="true" 
										    	pattern="#{msg['pattern_date']}" mask="true"/>
				  			</h:panelGrid>
				  		<h:panelGroup layout="block" style="float:left">
				  			<p:commandButton icon="ui-icon-search" value="#{msg['btn_buscar']}" action="#{busquedaProformaFacturaController.listarfacturas()}"
				  			 update="pnlProformas" process="@this :frm:pnlfilter :frm:pnlfilterFecha"/>
				  			 
	      				<p:commandButton value="#{msg['btn_crear']}"
	      					icon="ui-icon-plusthick" action="#{busquedaProformaFacturaController.crear}"
	      					immediate="true"	process="@this"/>
				  			 
				  		</h:panelGroup>
				  	</p:fieldset>
				  	<p:fieldset legend="#{msg['lbl_facturas']}">
				  		<h:panelGroup layout="block" id="pnlProformas">
				  			<p:dataTable id="tblproforma" value="#{busquedaProformaFacturaDatamanager.tfaccabfacturasList}" var="item" scrollable="true"
							 style="width:auto;font: bold 100% monospace; " scrollWidth="900" scrollRows="20"  rows="25" paginator="true">
								<p:column headerText="#{msg.lbl_numero_factura}" style="width:90px">
									<p:outputLabel value="#{item.pk.numerofactura}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_cliente}"  style="width:100px">
									<p:outputLabel value="#{item.tfaccliente.tsyspersona.nombres} #{item.tfaccliente.tsyspersona.apellidos}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_dae}"  style="width:130px">
									<p:outputLabel value="#{item.referendo}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_farm_code}"  style="width:100px">
									<p:outputLabel value="#{item.farmcode}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_country_code}"  style="width:100px">
									<p:outputLabel value="#{item.countrycode}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_area}"  style="width:100px">
									<p:outputLabel value="#{item.area}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_fecha_despacho}"  style="width:100px">
									<p:outputLabel value="#{item.fechafactura}">
										<f:convertDateTime type="date" pattern="#{msg.pattern_date}"/>
									</p:outputLabel>
								</p:column>
								<p:column headerText="#{msg.lbl_fecha_vuelo}"  style="width:100px">
									<p:outputLabel value="#{item.fechaembarque}">
										<f:convertDateTime type="date" pattern="#{msg.pattern_date}"/>
									</p:outputLabel>
								</p:column>
								<p:column headerText="#{msg.lbl_master_awb}"  style="width:100px">
									<p:outputLabel value="#{item.masterawb}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_house_awb}"  style="width:100px">
									<p:outputLabel value="#{item.houseawb}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_aerolinea}"  style="width:100px">
									<p:outputLabel value="#{item.tadmairline.descripcion}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_total_pice}"  style="width:100px">
									<p:outputLabel value="#{item.totalpices}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_total_stems}"  style="width:100px">
									<p:outputLabel value="#{item.totalstems}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_total_price}"  style="width:100px">
									<p:outputLabel value="#{item.total}"/>
								</p:column>
								<p:column headerText="#{msg.lbl_estado}"  style="width:100px">
									<p:outputLabel value="#{item.tadmestadosri.descripcion}"/>
								</p:column>
								<p:column  style="width:35px">
									<p:commandButton icon="ui-icon-circle-check" title="#{msg['btn_seleccionar']}" 
									action="#{busquedaProformaFacturaController.selecionaFactura(item)}" process="@this tblproforma" immediate="true" >
				  					</p:commandButton>
				  				</p:column>
							</p:dataTable>
	
				  		</h:panelGroup>
			</p:fieldset>
		</p:panel>
	</ui:define>
</ui:composition>
